(function() {
  var Configuration, fs, path, spawn;
  path = require("path");
  fs = require("fs");
  spawn = require("child_process").spawn;
  Configuration = require("./puppy").Configuration;
  module.exports.command = function(args) {
    var configuration, server;
    configuration = new Configuration();
    server = configuration.get("server") || "portoroz.prettyrobots.com";
    delete configuration.local["home"];
    delete configuration.global["home"];
    return configuration.home(function(home) {
      var _ref, code, ssh, stdout;
      _ref = args;
      code = _ref[0];
      stdout = "";
      ssh = spawn("ssh", ["-T", home, "/puppy/bin/account_activated"]);
      ssh.stdin.end(code);
      ssh.stdout.on("data", function(chunk) {
        return process.stdout.write(chunk.toString());
      });
      ssh.stderr.on("data", function(chunk) {
        return process.stdout.write(chunk.toString());
      });
      return ssh.on("exit", function(code) {
        return code !== 0 ? process.stdout.write("Unable to activate.\n") : null;
      });
    });
  };
}).call(this);
